# Microsoft 365 Cost Management Configuration

# Azure AD Tenant ID
# Find in Azure Portal → Azure Active Directory → Overview → Tenant ID
TENANT_ID=your-tenant-id-here

# Application (Client) ID
# Find in Azure Portal → App registrations → Your app → Overview → Application (client) ID
CLIENT_ID=your-client-id-here

# Client Secret Value
# Find in Azure Portal → App registrations → Your app → Certificates & secrets → Client secrets
# Note: Copy the secret VALUE, not the secret ID
CLIENT_SECRET=your-client-secret-here

# Database Path (optional)
# Default: ./data/m365_costs.db
# DATABASE_PATH=./data/m365_costs.db

# Note: BATCH_SIZE is no longer used.
# The script now uses Graph API's maximum page size (999 users) and writes
# to database incrementally during fetch with constant memory usage.
# Checkpoints are created after each page for full resumability.

# Setup Instructions:
#
# 1. Create an Azure AD app registration:
#    - Go to Azure Portal → Azure Active Directory → App registrations
#    - Click "New registration"
#    - Name: "M365 Cost Management"
#    - Supported account types: "Accounts in this organizational directory only"
#    - Click "Register"
#
# 2. Note the Application (client) ID and Tenant ID
#
# 3. Create a client secret:
#    - In your app registration → Certificates & secrets
#    - Click "New client secret"
#    - Description: "M365 Cost Management Script"
#    - Expires: Choose expiration (e.g., 6 months, 12 months)
#    - Click "Add"
#    - IMPORTANT: Copy the secret VALUE immediately (you won't see it again)
#
# 4. Configure API permissions:
#    - In your app registration → API permissions
#    - Click "Add a permission"
#    - Select "Microsoft Graph"
#    - Select "Application permissions" (not Delegated)
#    - Add these permissions:
#      * Organization.Read.All
#      * User.Read.All
#      * Directory.Read.All
#    - Click "Add permissions"
#
# 5. Grant admin consent:
#    - In API permissions page → Click "Grant admin consent for [Your Org]"
#    - Click "Yes" to confirm
#    - Wait 5-10 minutes for changes to propagate
#
# 6. Copy this file to .env and fill in your values:
#    cp .env.example .env
#    # Edit .env with your actual credentials
#
# 7. Test the configuration:
#    uv run python scripts/collect_m365_data.py
